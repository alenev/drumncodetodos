### todo CRUD API

## API з бізнес-логікою CRUD для todo

Кожне todo має такі властивості:
- id_user - приналежність користувачу
- id_parent_todo - приналежність іншому todo як дочірне
- status (todo, done)
- priority (1...5)
- title - заголовок todo
- description - опис todo
- created_at - дата створення
- completed_at - дата завершення (status done)
- updated_at - дата оновлення даних

Будь-яке todo може мати дочірні todo необмеженого рівня вкладеності.

API надає можливість:
- отримати список todo користувача відповідно до фільтра
- Створити todo користувача
- Редагувати todo користувача
- Видалити todo користувача
- відзначити todo користувача як виконане

При отриманні списку todo користувач має можливість:
- фільтрувати масив todo по полю status (todo, done)
- фільтрувати масив todo по полю пріоритет - від і до
- фільтрувати масив todo по полю заголовок (повнотекстовий пошук)
- сортувати за часом створення, часу виконання, пріоритетом

Користувач обмежений варіантами умов валідації:
- Змінювати або видаляти чужі todo
- Видалити вже виконане todo (статус done)
- відзначити як виконане todo у якого є невиконані дочірні todo

## Особливості реалізації:
- Ця реалізація API з точками для CRUD сутностей ToDo має мінімальну демо-архітектуру й не містить логіки авторизації користувача. На вхід точок API в цій реалізації відразу подається id-користувача. В умовах реалізації API для фронтенду замість id користувача має подаватися токен авторизації користувача, який видається окремою точкою API логіна користувача при умові успішної авторизації. Цей токен логіну в API  надає доступ до всіх закритих точок API, які передбачать авторизацію користувача, і в методах контролерів API дає можливість отримання id користувача якому він був виданий точкою логіну API. Ця демо-реалізація API написана на версії 10.23.1 Laravel й для цієї версії, на мій погляд, краще реалізовувати авторизацію користувача на базі пакета Passport.
- В контролері з методами CRUD для ToDo (app\Http\Controllers\API\ToDosController.php) методи використовують для роботи з БД репозиторій (app\Repositories\API\ToDosRepository.php) моделі таблиці БД ToDo. такий підхід дозволяє додавати інші репозиторії з іншими методами роботи з моделлю таблиці БД ToDo для інших контролерів за наявності потреби. Така потреба може з'явитися для отримання змінених або додаткових методів моделі без потреби втручання в код основного репозиторію роботи з моделлю.
- Кожен метод контролера ToDo має окремий обробник валідації request.
- На вхід точок API CRUD ToDo можна подавати дані як у форматі JSON, так і як form data. На виході точки видають json.
- Для відповідей точок API, як успішних, так й з помилками, реалізовані уніфіковані методи apiResponceSuccess й apiResponceError в класі базового контролера. Метод apiResponceError разом з кодом відповіді API надає текст помилки від валідатора request (Illuminate\Foundation\Http\FormRequest) 
- В фільтрації виборки todo пошук в полях БД todo 'title' й 'description' реалізований через метод query()->whereFullText(). Це простий варіант для цього демо. В умовах розробки краще використовувати пакет Laravel Scout. 
- З .gitignore виключений .env, щоб він знаходився в репозиторії для прикладу. Внизу .env є деякі додаткові параметри конфігу які використовуються і потрібні в ньому. Виключити його апдейти на хості можна через pipeline CI/CD.

## Встановлення збірки:    
1.
    ```sh
    composer install
    ```
2. ```sh
   php artisan migrate
   ```
3.
   ```sh
   php artisan db:seed --class=UsersSeeder
   ```
4.
   ```sh
   php artisan db:seed --class=ToDosSeeder
   ```
5.
    ```sh
    php artisan db:seed --class=ToDosStatusesSeeder
    ```
6.
   ```sh
   php artisan serve
   ```

## Точки API:
1) http://localhost:8000/api/todos/statuses/get - вибірка наявних в БД статусів todo; На вхід параметри не передаються.
2) http://localhost:8000/api/todos/create - створення нового Todo
Приклад вхідних даних { "id_user": 1, "id_parent_todo": 58, "id_status": 1, "priority": 1, "title": "Lorem Ipsum", "description": "Lorem Ipsum is simply dummy text of the printing and typesetting industry."}
Поля вхідних даних:
- "id_user" (int), обов'язкове; ID користувача який створює todo. Для проходження валідації користувач з таким ID має бути в БД;
- "id_parent_todo" (int), обов'язкове. ID батьківського todo. По замовчанню значення 0;
- "id_status" (int), обов'язкове. ID статуса todo з таблиці БД 'todos_statuses'; 
- "priority" (string), обов'язкове. ID приоритета todo. Має містити число від 1 до 5;
- "title" (string), обов'язкове. Текст заголовка todo; 
- "description" (string), необов'язкове. Текст опису todo.
3) http://localhost:8000/api/todos/get - вибірка ToDo користувача з можливостями фільтрації виборки
Приклад вхідних даних { "id_user": 1, "id_parent_todo": 0, "id_status": 0, "priority": "1,5", "search_keywords": "", "child_todos": 0, "sort_field": "created_at", "sort_order": "desc"}
Поля вхідних даних:
- "id_user" (int), обов'язкове;
- "id_parent_todo" (int), необов'язкове. ID батьківського todo. Якщо значення 0, то вибірка здійснюється без урахування цього параметру;
- "id_status" (int), необов'язкове.ID статусу todo. Якщо значення 0, то вибірка здійснюється без урахування цього параметру;
- "priority" (string), необов'язкове. ID приоритета todo. Має містити два числа й кому між ними. Вибірка при цьому здійснюється з фільтрацією значень в БД цього поля які знаходяться в діапазоні між двома переданими значеннями враховуючи їх;
- "search_keywords" (string), необов'язкове. Одне чи декілька слів пошукового запиту по яким здійсбнюється пошук в полях БД todo 'title' й 'description' для фільтрації по ним виборки todo. Пошук здійснюється повнотекстовий.  
4) http://localhost:8000/api/todos/todos/update - апдейт даних окремого todo з набором умов валідації можливостей апдейту
Приклад вхідних даних { "id": 45, "id_user": 1, "id_parent_todo": 0, "id_status": 2, "priority": 4, "title": "Aut recusandae dolor ut.",  "description": "Sit ad odit quia labore et beatae quam."}
- "id" (int), обов'язкове; ID todo дані якого оновлюються;
- "id_user" (int), обов'язкове; ID користувача який створює todo. Для проходження валідації користувач з таким ID має бути в БД;
- "id_parent_todo" (int), обов'язкове. ID батьківського todo. По замовчанню значення 0;
- "id_status" (int), обов'язкове. ID статусу todo з таблиці БД 'todos_statuses'; При встановлені id статусу у якого name=done відбувається валідація можливості зміни статусу на нього;
- "priority" (string), обов'язкове. ID приоритета todo. Має містити число від 1 до 5;
- "title" (string), обов'язкове. Текст заголовка todo; 
- "description" (string), необов'язкове. Текст опису todo;
- "sort_field" (string), необов'язкове. Назва поля в БД по якому буде відсортована вибірка. Можливі значення 'created_at', 'completed_at', 'priority';
- "sort_order" (string), необов'язкове. Можливі варіанти asc й desc. Напрямок сортування виборки по значенню даних з "sort_field". 
5) http://localhost:8000/api/todos/delete - видалення окремого todo з набором умов валідації можливостей видалення
Приклад вхідних даних {"id": 85, "id_user": 1}
- "id" (int), обов'язкове; ID todo яке видаляється;
- "id_user" (int), обов'язкове; ID користувача власника todo. Для проходження валідації користувач з таким ID має бути в БД;

